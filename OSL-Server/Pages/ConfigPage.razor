@page "/config"
@using OSL_Server.Communication
@using static OSL_Server.Pages.ConfigPage.ConfigOverlayText
@using Microsoft.AspNetCore.SignalR.Client
@using MudBlazor

<PageTitle>Config</PageTitle>
<div class="parent">
    <div class="Configuration">
        <div class="content">
            <h1 class="title">Configuration :</h1>
            <br />
            <div>
                <h2 class ="title">Server Configuration :</h2>
                <br />
                <EditForm Model="@OverlayText" OnValidSubmit="@PortServerSubmit">
                    <DataAnnotationsValidator />
                    <ValidationSummary />
                    <label style="font-weight: bold">Port (@AsyncServer.portSocketOSLServer) : </label>
                    <InputNumber id="name" @bind-Value="OverlayText.Port" placeholder="45678" />
                    <button class="btn btn-primary button-form" style="background-color: darkgreen" type="submit">Submit</button>
                </EditForm>
                <button class="btn btn-primary button-form" style="background-color: darkred" @onclick="@ResetPortServerSubmit">Reset Port</button>
            </div>
            <br />
            <div>
                <h2 class="title">Configuration champ select View 1 :</h2>
                <br />
                Load configuration file
                <InputFile OnChange=LoadFiles /><button class="btn btn-primary button-form" style="background-color: darkgreen" type="submit" @onclick="@LoadFileChampSelectView1">Submit</button>
                <br />
                <br />
                <a class="btn btn-primary button-form" style="background-color: darkgreen" href="@GenerateConfigFileChampSelectView1()" download>
                    Generate a configuration file
                </a>
            </div>
            <br />
            <div>
                <h2 class="title">Configuration champ select View 2 :</h2>
                <br />
                Load configuration file
                <InputFile OnChange=LoadFiles /><button class="btn btn-primary button-form" style="background-color: darkgreen" type="submit" @onclick="@LoadFileChampSelectView2">Submit</button>
                <br />
                <br />
                <a class="btn btn-primary button-form" style="background-color: darkgreen" href="@GenerateConfigFileChampSelectView2()" download>
                    Generate a configuration file
                </a>
            </div>
            <br />
            <div>
                <h2 class="title">Configuration champ select View 3 :</h2>
                <br />
                Load configuration file
                <InputFile OnChange=LoadFiles /><button class="btn btn-primary button-form" style="background-color: darkgreen" type="submit" @onclick="@LoadFileChampSelectView3">Submit</button>
                <br />
                <br />
                <a class="btn btn-primary button-form" style="background-color: darkgreen" href="@GenerateConfigFileChampSelectView3()" download>
                    Generate a configuration file
                </a>
            </div>
            <br />
            <div>
                <h2 class="title">Configuration champ select View 4 :</h2>
                <br />
                Load configuration file
                <InputFile OnChange=LoadFiles /><button class="btn btn-primary button-form" style="background-color: darkgreen" type="submit" @onclick="@LoadFileChampSelectView4">Submit</button>
                <br />
                <br />
                <a class="btn btn-primary button-form" style="background-color: darkgreen" href="@GenerateConfigFileChampSelectView4()" download>
                    Generate a configuration file
                </a>
            </div>
            <br />
            <div>
                <h2 class ="title"><u>Configuration in game View 1 :</u></h2>
                <br />
                Load configuration file
                <InputFile OnChange=LoadFiles /><button class="btn btn-primary button-form" style="background-color: darkgreen" type="submit" @onclick="@LoadFileInGameView1">Submit</button>
                <br />
                <br />
                <a class="btn btn-primary button-form" style="background-color: darkgreen" href="@GenerateConfigFileInGameView1()" download>
                    Generate a configuration file
                </a>
            </div>
            <br />
            <div>
                <h2 class ="title">Configuration in game View 2 :</h2>
                <br />
                Load configuration file
                <InputFile OnChange=LoadFiles /><button class="btn btn-primary button-form" style="background-color: darkgreen" type="submit" @onclick="@LoadFileInGameView2">Submit</button>
                <br />
                <br />
                <a class="btn btn-primary button-form" style="background-color: darkgreen" href="@GenerateConfigFileInGameView2()" download>
                    Generate a configuration file
                </a>
            </div>
            <br />
            <div>
                <h2 class ="title">Configuration in game View 3 :</h2>
                <br />
                Load configuration file
                <InputFile OnChange=LoadFiles /><button class="btn btn-primary button-form" style="background-color: darkgreen" type="submit" @onclick="@LoadFileInGameView3">Submit</button>
                <br />
                <br />
                <a class="btn btn-primary button-form" style="background-color: darkgreen" href="@GenerateConfigFileInGameView3()" download>
                    Generate a configuration file
                </a>
            </div>
            <br />
            <br />
        </div>
    </div>
</div>

<MudThemeProvider />
<MudDialogProvider />
<MudSnackbarProvider />

@code {
    public static ConfigOverlayText OverlayText = new();
    private HubConnection? hubConnection;

    private void PortServerSubmit()
    {
        AsyncServer.portSocketOSLServer = OverlayText.Port;
        ServerHub.SendPort();
    }

    private void ResetPortServerSubmit()
    {
        OverlayText.Port = 45678;
        AsyncServer.portSocketOSLServer = 45678;
        ServerHub.SendPort();
    }
}
